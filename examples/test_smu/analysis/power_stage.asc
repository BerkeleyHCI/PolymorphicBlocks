Version 4
SHEET 1 1920 1408
WIRE 1088 -48 1056 -48
WIRE 1200 -48 1168 -48
WIRE 720 0 672 0
WIRE 1056 16 1056 -48
WIRE 1056 16 1024 16
WIRE 672 32 672 0
WIRE 672 32 624 32
WIRE 704 32 672 32
WIRE 1056 48 1056 16
WIRE 1088 48 1056 48
WIRE 672 64 672 32
WIRE 720 64 672 64
WIRE 1200 64 1200 -48
WIRE 1200 64 1152 64
WIRE 1232 64 1200 64
WIRE 1088 80 1056 80
WIRE 96 112 64 112
WIRE 192 112 160 112
WIRE 400 112 368 112
WIRE 432 112 400 112
WIRE 544 112 512 112
WIRE 768 112 768 80
WIRE 944 112 912 112
WIRE 1056 112 1056 80
WIRE 1056 112 1024 112
WIRE -96 160 -384 160
WIRE 1056 160 1056 112
WIRE 1088 160 1056 160
WIRE 1200 160 1168 160
WIRE -416 192 -448 192
WIRE 400 208 400 112
WIRE 432 208 400 208
WIRE -384 224 -384 160
WIRE -368 224 -384 224
WIRE 544 224 544 112
WIRE 544 224 496 224
WIRE 624 224 624 32
WIRE 624 224 544 224
WIRE 656 224 624 224
WIRE 768 224 768 192
WIRE 768 224 736 224
WIRE 912 224 912 112
WIRE 912 224 768 224
WIRE -240 240 -304 240
WIRE -96 240 -96 160
WIRE -96 240 -160 240
WIRE -64 240 -96 240
WIRE 64 240 64 112
WIRE 64 240 16 240
WIRE 96 240 64 240
WIRE 432 240 400 240
WIRE -416 256 -416 192
WIRE -368 256 -416 256
WIRE 192 256 192 112
WIRE 192 256 160 256
WIRE 400 256 400 240
WIRE 400 256 192 256
WIRE 768 256 768 224
WIRE 912 256 912 224
WIRE 96 272 64 272
WIRE -416 288 -416 256
WIRE -416 288 -448 288
WIRE -1200 320 -1200 288
WIRE -1104 320 -1104 288
WIRE -1104 320 -1200 320
WIRE -1008 320 -1008 288
WIRE -1008 320 -1104 320
WIRE 1104 320 1088 320
WIRE -1200 352 -1200 320
WIRE -1104 352 -1104 320
WIRE -1008 352 -1008 320
WIRE 768 368 768 336
WIRE 912 368 912 336
WIRE 1024 368 912 368
WIRE 720 384 672 384
WIRE -96 400 -96 240
WIRE -96 400 -384 400
WIRE 624 416 624 224
WIRE 672 416 672 384
WIRE 672 416 624 416
WIRE 704 416 672 416
WIRE -416 432 -448 432
WIRE 1024 432 992 432
WIRE 672 448 672 416
WIRE 720 448 672 448
WIRE 992 448 992 432
WIRE 992 448 912 448
WIRE -384 464 -384 400
WIRE -368 464 -384 464
WIRE -272 480 -304 480
WIRE -96 480 -96 400
WIRE -96 480 -128 480
WIRE 912 480 912 448
WIRE 1104 480 1104 320
WIRE 1104 480 1088 480
WIRE -416 496 -416 432
WIRE -368 496 -416 496
WIRE -416 528 -416 496
WIRE -416 528 -448 528
FLAG 768 -16 +V
FLAG 768 464 -V
FLAG -1008 432 -V
FLAG -1008 208 +V
FLAG -1200 352 0
FLAG 464 256 -V
FLAG 464 192 +V
FLAG 912 224 out
FLAG 624 32 drive
FLAG -896 240 signal
FLAG 1168 400 isen
FLAG 912 480 0
FLAG -1104 208 +Vdd
FLAG 1056 320 +Vdd
FLAG -336 208 +Vdd
FLAG -528 192 signal
FLAG -1200 208 +Vref
FLAG 1232 64 vsen
FLAG -1104 432 -Vdd
FLAG 1056 480 -Vdd
FLAG 128 224 +Vdd
FLAG -928 64 0
FLAG 944 16 0
FLAG -528 288 vsen
FLAG 1104 480 +Vref
FLAG 64 272 +Vref
FLAG 1200 160 +Vref
FLAG 288 112 +Vref
FLAG -336 448 +Vdd
FLAG -528 528 isen
FLAG -608 432 +Vref
FLAG 128 288 -Vdd
FLAG -336 272 -Vdd
FLAG -336 512 -Vdd
FLAG -896 320 +Vref
FLAG 1120 32 +Vdd
FLAG 1120 96 -Vdd
SYMBOL pnp 704 464 M180
SYMATTR InstName Q1
SYMATTR Value D45H11
SYMBOL npn 704 -16 R0
SYMATTR InstName Q2
SYMATTR Value FZT849
SYMBOL voltage -1008 192 R0
SYMATTR InstName V1
SYMATTR Value 20
SYMBOL voltage -1008 336 R0
SYMATTR InstName V2
SYMATTR Value 5
SYMBOL res 896 352 R0
SYMATTR InstName Rsen
SYMATTR Value .005
SYMBOL voltage -896 224 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value SINE(-.25 .25 1000)
SYMBOL res 752 240 R0
SYMATTR InstName R2
SYMATTR Value 0
SYMBOL res 752 96 R0
SYMATTR InstName R3
SYMATTR Value 0
SYMBOL res 896 240 R0
SYMATTR InstName Rload1
SYMATTR Value .995
SYMBOL Opamps\\AD8418A 1056 400 R0
SYMATTR InstName U2
SYMBOL voltage -1104 192 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value 2.5
SYMBOL voltage -1200 192 R0
SYMATTR InstName V5
SYMATTR Value 1.25
SYMBOL res 528 96 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 22k
SYMBOL res 384 96 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 1k
SYMBOL voltage -1104 336 R0
SYMATTR InstName V7
SYMATTR Value 0
SYMBOL cap 160 96 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C4
SYMATTR Value 4.7n
SYMBOL Opamps\\AD8691 464 160 R0
SYMATTR InstName U7
SYMBOL voltage -928 -32 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V9
SYMATTR Value SINE(0 10 1000)
SYMBOL res 1184 -64 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R15
SYMATTR Value 10k
SYMBOL res 1040 0 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R16
SYMATTR Value 200k
SYMBOL res 1040 96 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R17
SYMATTR Value 200k
SYMBOL res 1184 144 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R18
SYMATTR Value 10k
SYMBOL res -432 272 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 10k
SYMBOL res -432 176 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 10k
SYMBOL res -432 512 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R20
SYMATTR Value 10k
SYMBOL res -432 416 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R21
SYMATTR Value 10k
SYMBOL diode -272 496 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D3
SYMATTR Value 1N4148
SYMBOL res -112 464 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R22
SYMATTR Value 1
SYMBOL res -144 224 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R23
SYMATTR Value 4.7k
SYMBOL voltage -512 432 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName V10
SYMATTR Value -.5
SYMBOL res 32 224 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value 4.7k
SYMBOL res 752 208 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 4.7k
SYMBOL Opamps\\AD8628 -336 176 R0
SYMATTR InstName U1
SYMBOL Opamps\\AD8628 -336 416 R0
SYMATTR InstName U4
SYMBOL Opamps\\AD8628 128 192 R0
SYMATTR InstName U5
SYMBOL Opamps\\AD8628 1120 0 R0
SYMATTR InstName U6
TEXT 424 16 Left 2 ;Driver\nAmplifier
TEXT 720 -80 Left 2 ;Driver
TEXT 984 552 Left 2 ;Current Sense\n(20V/V)
TEXT -376 128 Left 2 ;Voltage Control
TEXT 80 16 Left 2 ;Error\nIntegrator
TEXT -376 368 Left 2 ;Source Control
TEXT -1234 616 Left 2 !.tran 10ms uic
TEXT 1208 -40 Left 2 ;1/20 V/V differential voltage sense\n(re-centering 0V -> +Vref)
