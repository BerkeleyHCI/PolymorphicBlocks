Version 4
SHEET 1 1328 864
WIRE 912 -48 880 -48
WIRE 1008 -48 992 -48
WIRE 880 16 880 -48
WIRE 880 48 880 16
WIRE 912 48 880 48
WIRE 608 64 592 64
WIRE 1008 64 1008 -48
WIRE 1008 64 976 64
WIRE 1040 64 1008 64
WIRE 912 80 880 80
WIRE 592 96 592 64
WIRE 592 96 560 96
WIRE 880 112 880 80
WIRE 592 128 592 96
WIRE 608 128 592 128
WIRE 400 144 352 144
WIRE -96 160 -272 160
WIRE 880 160 880 112
WIRE 912 160 880 160
WIRE -352 192 -352 160
WIRE 272 208 272 144
WIRE 304 208 272 208
WIRE -352 224 -352 192
WIRE -336 224 -352 224
WIRE 400 224 400 144
WIRE 400 224 368 224
WIRE 560 224 560 96
WIRE 560 224 400 224
WIRE 800 224 800 112
WIRE 800 224 656 224
WIRE -176 240 -272 240
WIRE -96 240 -96 160
WIRE 48 240 48 144
WIRE 48 240 -16 240
WIRE 304 240 272 240
WIRE -336 256 -352 256
WIRE 112 256 112 144
WIRE 272 256 272 240
WIRE 272 256 112 256
WIRE -352 288 -352 256
WIRE -1200 320 -1200 288
WIRE -1104 320 -1104 288
WIRE -1104 320 -1200 320
WIRE -1008 320 -1008 288
WIRE -1008 320 -1104 320
WIRE -352 320 -352 288
WIRE 608 320 592 320
WIRE 992 320 976 320
WIRE -1104 352 -1104 320
WIRE -1008 352 -1008 320
WIRE 560 352 560 224
WIRE 592 352 592 320
WIRE 592 352 560 352
WIRE 800 368 800 304
WIRE 912 368 800 368
WIRE 592 384 592 352
WIRE 608 384 592 384
WIRE -96 432 -96 240
WIRE -96 432 -304 432
WIRE 912 432 880 432
WIRE 880 448 880 432
WIRE 880 448 800 448
WIRE -384 464 -384 432
WIRE 800 480 800 448
WIRE 992 480 992 320
WIRE 992 480 976 480
WIRE -384 496 -384 464
WIRE -368 496 -384 496
WIRE -240 512 -304 512
WIRE -96 512 -96 432
WIRE -368 528 -384 528
WIRE -384 560 -384 528
WIRE -928 576 -1088 576
WIRE -928 592 -928 576
WIRE -864 592 -928 592
WIRE -384 592 -384 560
WIRE -768 608 -800 608
WIRE -864 624 -1008 624
WIRE -928 752 -1088 752
WIRE -928 768 -928 752
WIRE -864 768 -928 768
WIRE -768 784 -800 784
WIRE -624 784 -624 608
WIRE -864 800 -1008 800
FLAG 656 48 +V
FLAG 656 400 -V
FLAG -1008 432 -V
FLAG -1008 208 +V
FLAG -1200 320 0
FLAG 336 256 -V
FLAG 336 192 +V
FLAG 800 224 out
FLAG -896 320 0
FLAG 560 96 drive
FLAG -896 240 signal
FLAG 1056 400 isen
FLAG 800 480 0
FLAG -1104 208 +Vdd
FLAG 944 320 +Vdd
FLAG -304 208 +Vdd
FLAG -432 192 signal
FLAG -832 576 +Vdd
FLAG -1200 208 +Vref
FLAG -1168 576 isen
FLAG 1040 64 vsen
FLAG -272 240 vctl
FLAG -800 608 sinctl
FLAG -1104 432 -Vdd
FLAG -832 752 +Vdd
FLAG -1168 752 isen
FLAG -1088 800 +Vref
FLAG -800 784 srcctl
FLAG 944 480 -Vdd
FLAG 80 224 +Vdd
FLAG 320 416 -Vdd
FLAG -928 64 0
FLAG 944 32 +V
FLAG 944 96 -V
FLAG 800 16 0
FLAG -432 288 vsen
FLAG 976 480 +Vref
FLAG -1088 624 +Vref
FLAG 48 272 +Vref
FLAG 992 160 +Vref
FLAG 80 288 0
FLAG -832 640 0
FLAG -832 816 0
FLAG 240 384 +Vref
FLAG -304 272 0
FLAG -272 320 +Vref
FLAG 192 144 +Vref
FLAG -336 480 +Vdd
FLAG -336 544 0
FLAG -304 592 +Vref
FLAG -464 560 isen
FLAG -544 464 +Vref
SYMBOL pnp 592 400 M180
SYMATTR InstName Q1
SYMATTR Value D45H11
SYMBOL npn 592 48 R0
SYMATTR InstName Q2
SYMATTR Value FZT849
SYMBOL voltage -1008 192 R0
SYMATTR InstName V1
SYMATTR Value 20
SYMBOL voltage -1008 336 R0
SYMATTR InstName V2
SYMATTR Value 20
SYMBOL res 784 352 R0
SYMATTR InstName Rsen
SYMATTR Value .005
SYMBOL voltage -896 224 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value SINE(1.25 .5 100)
SYMBOL res 640 208 R0
SYMATTR InstName R2
SYMATTR Value 0
SYMBOL res 640 128 R0
SYMATTR InstName R3
SYMATTR Value 0
SYMBOL res 784 208 R0
SYMATTR InstName Rload1
SYMATTR Value .995
SYMBOL Opamps\\AD8418A 944 400 R0
SYMATTR InstName U2
SYMBOL voltage -1104 192 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value 2.5
SYMBOL res -608 592 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 470
SYMBOL diode -768 624 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D2
SYMBOL voltage -1200 192 R0
SYMATTR InstName V5
SYMATTR Value 1.25
SYMBOL voltage -992 624 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName V6
SYMATTR Value -.4
SYMBOL res 368 128 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 22k
SYMBOL res 288 128 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 1k
SYMBOL voltage -1104 336 R0
SYMATTR InstName V7
SYMATTR Value 2.5
SYMBOL res -608 768 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 470
SYMBOL diode -704 768 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D1
SYMBOL voltage -992 800 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName V8
SYMATTR Value .4
SYMBOL res -1072 736 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value 10k
SYMBOL cap 112 128 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C4
SYMATTR Value 10n
SYMBOL res 0 224 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value 4.7k
SYMBOL res -1072 560 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R14
SYMATTR Value 10k
SYMBOL Opamps\\AD8691 336 160 R0
SYMATTR InstName U7
SYMBOL Opamps\\AD8691 -832 720 R0
SYMATTR InstName U3
SYMBOL Opamps\\AD8691 -832 544 R0
SYMATTR InstName U4
SYMBOL voltage -928 -32 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V9
SYMATTR Value SINE(0 10 100)
SYMBOL Opamps\\AD8691 944 0 R0
SYMATTR InstName U6
SYMBOL res 1008 -64 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R15
SYMATTR Value 10k
SYMBOL res 896 0 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R16
SYMATTR Value 200k
SYMBOL res 896 96 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R17
SYMATTR Value 200k
SYMBOL res 1008 144 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R18
SYMATTR Value 10k
SYMBOL res -256 144 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 10k
SYMBOL res -256 304 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 10k
SYMBOL res -336 272 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 10k
SYMBOL res -336 176 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 10k
SYMBOL res -288 416 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R13
SYMATTR Value 10k
SYMBOL res -288 576 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R19
SYMATTR Value 10k
SYMBOL res -368 544 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R20
SYMATTR Value 10k
SYMBOL res -368 448 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R21
SYMATTR Value 10k
SYMBOL diode -240 528 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D3
SYMATTR Value 1N4148
SYMBOL res -80 496 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R22
SYMATTR Value 1k
SYMBOL res -80 224 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R23
SYMATTR Value 4.7k
SYMBOL voltage -448 464 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName V10
SYMATTR Value .45
SYMBOL Opamps\\AD8538 -336 448 R0
SYMATTR InstName U9
SYMBOL Opamps\\AD8538 -304 176 R0
SYMATTR InstName U5
SYMBOL Opamps\\AD8538 80 192 R0
SYMATTR InstName U1
TEXT -312 72 Left 2 !.tran 0.02 uic
TEXT 272 56 Left 2 ;Driver\nAmplifier
TEXT 576 -16 Left 2 ;Driver
TEXT 872 552 Left 2 ;Current Sense\n(20V/V)
TEXT -416 112 Left 2 ;Voltage Control
TEXT -984 536 Left 2 ;Sink Limit
TEXT -1016 712 Left 2 ;Source Limit
TEXT 80 56 Left 2 ;Error\nIntegrator
TEXT -448 384 Left 2 ;Source Control
