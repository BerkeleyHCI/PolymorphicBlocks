Version 4
SHEET 1 1680 1212
WIRE 912 -48 880 -48
WIRE 1008 -48 992 -48
WIRE 880 16 880 -48
WIRE 880 48 880 16
WIRE 912 48 880 48
WIRE 608 64 592 64
WIRE 1008 64 1008 -48
WIRE 1008 64 976 64
WIRE 1040 64 1008 64
WIRE 912 80 880 80
WIRE 592 96 592 64
WIRE 592 96 560 96
WIRE 176 112 32 112
WIRE 880 112 880 80
WIRE 592 128 592 96
WIRE 608 128 592 128
WIRE 432 144 384 144
WIRE 880 160 880 112
WIRE 912 160 880 160
WIRE 304 208 304 144
WIRE 336 208 304 208
WIRE 432 224 432 144
WIRE 432 224 400 224
WIRE 560 224 560 96
WIRE 560 224 432 224
WIRE 800 224 800 112
WIRE 800 224 656 224
WIRE -32 240 -32 112
WIRE 336 240 304 240
WIRE 96 256 32 256
WIRE 176 256 176 112
WIRE 224 256 176 256
WIRE 304 256 304 240
WIRE 304 256 224 256
WIRE -1200 320 -1200 288
WIRE -1104 320 -1104 288
WIRE -1104 320 -1200 320
WIRE -1008 320 -1008 288
WIRE -1008 320 -1104 320
WIRE 608 320 592 320
WIRE 992 320 976 320
WIRE -96 336 -112 336
WIRE 224 336 224 256
WIRE 224 336 -32 336
WIRE -1104 352 -1104 320
WIRE -1008 352 -1008 320
WIRE 560 352 560 224
WIRE 592 352 592 320
WIRE 592 352 560 352
WIRE 800 368 800 304
WIRE 912 368 800 368
WIRE 592 384 592 352
WIRE 608 384 592 384
WIRE -112 416 -112 336
WIRE 912 432 880 432
WIRE 1632 432 1600 432
WIRE -112 448 -112 416
WIRE -96 448 -112 448
WIRE 880 448 880 432
WIRE 880 448 800 448
WIRE 32 464 -32 464
WIRE 144 464 96 464
WIRE 224 464 224 336
WIRE 1520 464 1520 432
WIRE -96 480 -112 480
WIRE 800 480 800 448
WIRE 992 480 992 320
WIRE 992 480 976 480
WIRE 1520 496 1520 464
WIRE 1536 496 1520 496
WIRE -112 512 -112 480
WIRE 1632 512 1632 432
WIRE 1632 512 1600 512
WIRE 1536 528 1520 528
WIRE 1440 544 1440 464
WIRE 1520 560 1520 528
WIRE -928 576 -1088 576
WIRE -928 592 -928 576
WIRE -864 592 -928 592
WIRE 1520 592 1520 560
WIRE -768 608 -800 608
WIRE -864 624 -1008 624
WIRE 736 704 688 704
WIRE 176 720 0 720
WIRE -928 752 -1088 752
WIRE -80 752 -80 720
WIRE -928 768 -928 752
WIRE -864 768 -928 768
WIRE 608 768 608 704
WIRE 640 768 608 768
WIRE -768 784 -800 784
WIRE -624 784 -624 608
WIRE -80 784 -80 752
WIRE -64 784 -80 784
WIRE 736 784 736 704
WIRE 736 784 704 784
WIRE -864 800 -1008 800
WIRE 96 800 0 800
WIRE 176 800 176 720
WIRE 384 800 384 704
WIRE 384 800 256 800
WIRE 640 800 608 800
WIRE -64 816 -80 816
WIRE 448 816 448 704
WIRE 608 816 608 800
WIRE 608 816 448 816
WIRE -80 848 -80 816
WIRE -80 880 -80 848
WIRE 176 992 -32 992
WIRE -112 1024 -112 992
WIRE -112 1056 -112 1024
WIRE -96 1056 -112 1056
WIRE 32 1072 -32 1072
WIRE 176 1072 176 992
WIRE -96 1088 -112 1088
WIRE -112 1120 -112 1088
WIRE -112 1152 -112 1120
FLAG 656 48 +V
FLAG 656 400 -V
FLAG -1008 432 -V
FLAG -1008 208 +V
FLAG -1200 320 0
FLAG 672 816 -V
FLAG 672 752 +V
FLAG 800 224 out
FLAG -896 320 0
FLAG 560 96 drive
FLAG -896 240 signal
FLAG 1056 400 isen
FLAG 800 480 0
FLAG -1104 208 +Vdd
FLAG 944 320 +Vdd
FLAG -32 768 +Vdd
FLAG -160 752 signal
FLAG -832 576 +Vdd
FLAG -1200 208 +Vref
FLAG -1168 576 isen
FLAG 1040 64 vsen
FLAG -1104 432 -Vdd
FLAG -832 752 +Vdd
FLAG -1168 752 isen
FLAG -1088 800 +Vref
FLAG 944 480 -Vdd
FLAG 416 784 +Vdd
FLAG -928 64 0
FLAG 944 32 +V
FLAG 944 96 -V
FLAG 800 16 0
FLAG -160 848 vsen
FLAG 976 480 +Vref
FLAG -1088 624 +Vref
FLAG 384 832 +Vref
FLAG 992 160 +Vref
FLAG 416 848 0
FLAG -832 640 0
FLAG -832 816 0
FLAG 576 944 +Vref
FLAG -32 832 0
FLAG 0 880 +Vref
FLAG 528 704 +Vref
FLAG -64 1040 +Vdd
FLAG -64 1104 0
FLAG -32 1152 +Vref
FLAG -192 1120 isen
FLAG -272 1024 +Vref
FLAG 1600 592 0
FLAG 1568 480 +V
FLAG 1568 544 -V
FLAG 1440 560 +Vref
FLAG -112 240 vsen
FLAG -32 272 signal
FLAG 0 224 +Vdd
FLAG 0 288 0
FLAG 368 256 -V
FLAG 368 192 +V
FLAG 224 144 +Vref
FLAG -64 432 +Vdd
FLAG -64 496 0
FLAG -192 416 isen
FLAG -192 512 +Vref
SYMBOL pnp 592 400 M180
SYMATTR InstName Q1
SYMATTR Value D45H11
SYMBOL npn 592 48 R0
SYMATTR InstName Q2
SYMATTR Value FZT849
SYMBOL voltage -1008 192 R0
SYMATTR InstName V1
SYMATTR Value 20
SYMBOL voltage -1008 336 R0
SYMATTR InstName V2
SYMATTR Value 20
SYMBOL res 784 352 R0
SYMATTR InstName Rsen
SYMATTR Value .005
SYMBOL voltage -896 224 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value SINE(1.25 .5 1000)
SYMBOL res 640 208 R0
SYMATTR InstName R2
SYMATTR Value 0
SYMBOL res 640 128 R0
SYMATTR InstName R3
SYMATTR Value 0
SYMBOL res 784 208 R0
SYMATTR InstName Rload1
SYMATTR Value .995
SYMBOL Opamps\\AD8418A 944 400 R0
SYMATTR InstName U2
SYMBOL voltage -1104 192 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value 2.5
SYMBOL res -608 592 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 470
SYMBOL diode -768 624 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D2
SYMBOL voltage -1200 192 R0
SYMATTR InstName V5
SYMATTR Value 1.25
SYMBOL voltage -992 624 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName V6
SYMATTR Value -.4
SYMBOL res 704 688 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 22k
SYMBOL res 624 688 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 1k
SYMBOL voltage -1104 336 R0
SYMATTR InstName V7
SYMATTR Value 2.5
SYMBOL res -608 768 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 470
SYMBOL diode -704 768 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D1
SYMBOL voltage -992 800 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName V8
SYMATTR Value .4
SYMBOL res -1072 736 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value 10k
SYMBOL cap 448 688 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C4
SYMATTR Value 10n
SYMBOL res -1072 560 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R14
SYMATTR Value 10k
SYMBOL Opamps\\AD8691 672 720 R0
SYMATTR InstName U7
SYMBOL Opamps\\AD8691 -832 720 R0
SYMATTR InstName U3
SYMBOL Opamps\\AD8691 -832 544 R0
SYMATTR InstName U4
SYMBOL voltage -928 -32 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V9
SYMATTR Value SINE(0 10 1000)
SYMBOL Opamps\\AD8691 944 0 R0
SYMATTR InstName U6
SYMBOL res 1008 -64 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R15
SYMATTR Value 10k
SYMBOL res 896 0 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R16
SYMATTR Value 200k
SYMBOL res 896 96 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R17
SYMATTR Value 200k
SYMBOL res 1008 144 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R18
SYMATTR Value 10k
SYMBOL res 16 704 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 10k
SYMBOL res 16 864 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 10k
SYMBOL res -64 832 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 10k
SYMBOL res -64 736 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 10k
SYMBOL res -16 976 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R13
SYMATTR Value 10k
SYMBOL res -16 1136 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R19
SYMATTR Value 10k
SYMBOL res -96 1104 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R20
SYMATTR Value 10k
SYMBOL res -96 1008 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R21
SYMATTR Value 10k
SYMBOL diode 32 1088 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D3
SYMATTR Value 1N4148
SYMBOL res 192 1056 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R22
SYMATTR Value 1k
SYMBOL res 192 784 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R23
SYMATTR Value 4.7k
SYMBOL voltage -176 1024 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName V10
SYMATTR Value .45
SYMBOL Opamps\\AD8538 -64 1008 R0
SYMATTR InstName U9
SYMBOL Opamps\\AD8538 -32 736 R0
SYMATTR InstName U5
SYMBOL Opamps\\AD8538 416 752 R0
SYMATTR InstName U1
SYMBOL res 1616 416 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R25
SYMATTR Value 200k
SYMBOL res 1616 576 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R26
SYMATTR Value 200k
SYMBOL res 1536 544 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R27
SYMATTR Value 10k
SYMBOL res 1536 448 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R28
SYMATTR Value 10k
SYMBOL Opamps\\AD8538 1568 448 R0
SYMATTR InstName U8
SYMBOL res 272 784 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value 4.7k
SYMBOL res 400 128 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R24
SYMATTR Value 22k
SYMBOL res 320 128 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R29
SYMATTR Value 1k
SYMBOL Opamps\\AD8691 368 160 R0
SYMATTR InstName U11
SYMBOL cap 32 96 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value 1n
SYMBOL res -16 224 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R30
SYMATTR Value 10k
SYMBOL res -96 400 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R34
SYMATTR Value 10k
SYMBOL res 192 240 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R36
SYMATTR Value 4.7k
SYMBOL voltage -96 512 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName V12
SYMATTR Value -.4
SYMBOL cap -32 320 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value 1n
SYMBOL schottky 32 480 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D7
SYMATTR Value 1N5817
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL res 240 448 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R32
SYMATTR Value 100
SYMBOL Opamps\\LT1800 -64 400 R0
SYMATTR InstName U13
SYMBOL Opamps\\LT1800 0 192 R0
SYMATTR InstName U14
TEXT -312 72 Left 2 !.tran 0 0.002 0 uic
TEXT 608 616 Left 2 ;Driver\nAmplifier
TEXT 576 -16 Left 2 ;Driver
TEXT 872 552 Left 2 ;Current Sense\n(20V/V)
TEXT -144 672 Left 2 ;Voltage Control
TEXT -984 536 Left 2 ;Sink Limit
TEXT -1016 712 Left 2 ;Source Limit
TEXT 352 608 Left 2 ;Error\nIntegrator
TEXT -176 944 Left 2 ;Source Control
TEXT 1512 352 Left 2 ;Driver\nAmplifier
TEXT 304 56 Left 2 ;Driver\nAmplifier
TEXT -296 368 Left 2 ;Source Control
