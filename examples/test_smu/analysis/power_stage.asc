Version 4
SHEET 1 1920 1408
WIRE 1088 -48 1056 -48
WIRE 1200 -48 1168 -48
WIRE 720 0 672 0
WIRE 1056 16 1056 -48
WIRE 1056 16 1024 16
WIRE 672 32 672 0
WIRE 672 32 624 32
WIRE 704 32 672 32
WIRE 1056 48 1056 16
WIRE 1088 48 1056 48
WIRE 672 64 672 32
WIRE 720 64 672 64
WIRE 1200 64 1200 -48
WIRE 1200 64 1152 64
WIRE 1232 64 1200 64
WIRE 1296 64 1232 64
WIRE 1088 80 1056 80
WIRE 96 112 64 112
WIRE 192 112 160 112
WIRE 400 112 368 112
WIRE 432 112 400 112
WIRE 544 112 512 112
WIRE 768 112 768 80
WIRE 944 112 912 112
WIRE 1056 112 1056 80
WIRE 1056 112 1024 112
WIRE -96 160 -400 160
WIRE 1056 160 1056 112
WIRE 1088 160 1056 160
WIRE 1200 160 1168 160
WIRE -1056 192 -1056 160
WIRE -960 192 -960 160
WIRE -960 192 -1056 192
WIRE -864 192 -864 160
WIRE -864 192 -960 192
WIRE -656 192 -688 192
WIRE -560 192 -576 192
WIRE -544 192 -560 192
WIRE -432 192 -464 192
WIRE 400 208 400 112
WIRE 432 208 400 208
WIRE -1056 224 -1056 192
WIRE -960 224 -960 192
WIRE -864 224 -864 192
WIRE -400 224 -400 160
WIRE -368 224 -400 224
WIRE 544 224 544 112
WIRE 544 224 496 224
WIRE 624 224 624 32
WIRE 624 224 544 224
WIRE 656 224 624 224
WIRE 768 224 768 192
WIRE 768 224 736 224
WIRE 912 224 912 112
WIRE 912 224 768 224
WIRE -208 240 -304 240
WIRE -96 240 -96 160
WIRE -96 240 -128 240
WIRE -64 240 -96 240
WIRE 64 240 64 112
WIRE 64 240 16 240
WIRE 96 240 64 240
WIRE 432 240 400 240
WIRE -432 256 -432 192
WIRE -368 256 -432 256
WIRE 192 256 192 112
WIRE 192 256 160 256
WIRE 400 256 400 240
WIRE 400 256 192 256
WIRE 768 256 768 224
WIRE 96 272 64 272
WIRE -432 288 -432 256
WIRE -432 288 -464 288
WIRE 1152 304 1120 304
WIRE 1264 304 1232 304
WIRE 768 368 768 336
WIRE 912 368 912 224
WIRE 1120 368 1120 304
WIRE 1120 368 1088 368
WIRE 720 384 672 384
WIRE -96 400 -96 240
WIRE -96 400 -400 400
WIRE 1120 400 1120 368
WIRE 1152 400 1120 400
WIRE 624 416 624 224
WIRE 672 416 672 384
WIRE 672 416 624 416
WIRE 704 416 672 416
WIRE 1264 416 1264 304
WIRE 1264 416 1216 416
WIRE 1296 416 1264 416
WIRE 1360 416 1296 416
WIRE -656 432 -688 432
WIRE -560 432 -576 432
WIRE -544 432 -560 432
WIRE -432 432 -464 432
WIRE 1152 432 1120 432
WIRE 544 448 544 416
WIRE 672 448 672 416
WIRE 720 448 672 448
WIRE -400 464 -400 400
WIRE -368 464 -400 464
WIRE 912 464 1008 368
WIRE 912 464 912 448
WIRE 1008 464 912 368
WIRE 1120 464 1120 432
WIRE 1120 464 1088 464
WIRE -272 480 -304 480
WIRE -96 480 -96 400
WIRE -96 480 -128 480
WIRE -432 496 -432 432
WIRE -368 496 -432 496
WIRE 1120 512 1120 464
WIRE 1152 512 1120 512
WIRE 1264 512 1232 512
WIRE -432 528 -432 496
WIRE -432 528 -464 528
WIRE 400 560 352 560
WIRE 576 560 528 560
WIRE 912 560 912 464
WIRE 528 576 528 560
WIRE -96 624 -96 480
WIRE -96 624 -400 624
WIRE 352 640 352 560
WIRE -656 656 -688 656
WIRE -560 656 -576 656
WIRE -544 656 -560 656
WIRE -432 656 -464 656
WIRE 352 672 352 640
WIRE -400 688 -400 624
WIRE -368 688 -400 688
WIRE -272 704 -304 704
WIRE -96 704 -96 624
WIRE -96 704 -128 704
WIRE -432 720 -432 656
WIRE -368 720 -432 720
WIRE 528 736 528 576
WIRE -432 752 -432 720
WIRE -432 752 -464 752
WIRE 352 752 352 672
WIRE 400 752 352 752
WIRE 528 752 528 736
WIRE 576 752 528 752
FLAG 768 -16 +V
FLAG 544 416 -V
FLAG -864 304 -V
FLAG -864 80 +V
FLAG -1056 224 0
FLAG 1184 448 -V
FLAG 464 192 +V
FLAG 912 464 out
FLAG 624 32 drive
FLAG -560 192 vsig
FLAG 912 720 0
FLAG -960 80 +Vdd
FLAG -336 208 +Vdd
FLAG -1056 80 +Vref
FLAG 1232 64 vsen
FLAG -960 304 -Vdd
FLAG 128 224 +Vdd
FLAG 944 16 0
FLAG -544 288 vsen
FLAG 64 272 +Vref
FLAG 1200 160 +Vref
FLAG 288 112 +Vref
FLAG -336 448 +Vdd
FLAG -544 528 isen
FLAG -688 432 +Vref
FLAG 128 288 -Vdd
FLAG -336 272 -Vdd
FLAG -336 512 -Vdd
FLAG -688 192 +Vref
FLAG -560 432 i+sig
FLAG -336 672 +Vdd
FLAG -544 752 isen
FLAG -688 656 +Vref
FLAG -336 736 -Vdd
FLAG -560 656 i-sig
FLAG -96 160 verr
FLAG 192 112 vint
FLAG 1296 416 isen
FLAG 1264 512 +Vref
FLAG 1120 96 -V
FLAG 1120 32 +V
FLAG 1184 384 +V
FLAG 464 256 -V
FLAG 768 464 -V
FLAG 400 752 -V
FLAG 576 752 -V
SYMBOL pnp 704 464 M180
SYMATTR InstName Q1
SYMATTR Value D45H11
SYMBOL npn 704 -16 R0
SYMATTR InstName Q2
SYMATTR Value FZT849
SYMBOL voltage -864 64 R0
SYMATTR InstName V1
SYMATTR Value 20
SYMBOL voltage -864 208 R0
SYMATTR InstName V2
SYMATTR Value 0
SYMBOL res 896 352 R0
SYMATTR InstName Rsen
SYMATTR Value .1
SYMBOL res 752 240 R0
SYMATTR InstName R2
SYMATTR Value 0
SYMBOL res 752 96 R0
SYMATTR InstName R3
SYMATTR Value 0
SYMBOL voltage -960 64 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value 2.5
SYMBOL voltage -1056 64 R0
SYMATTR InstName V5
SYMATTR Value 1.25
SYMBOL res 528 96 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 20k
SYMBOL res 384 96 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 1k
SYMBOL voltage -960 208 R0
SYMATTR InstName V7
SYMATTR Value 0
SYMBOL cap 160 96 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C4
SYMATTR Value 1n
SYMBOL Opamps\\AD8691 464 160 R0
SYMATTR InstName U7
SYMBOL res 1184 -64 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R15
SYMATTR Value 10k
SYMBOL res 1040 0 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R16
SYMATTR Value 200k
SYMBOL res 1040 96 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R17
SYMATTR Value 200k
SYMBOL res 1184 144 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R18
SYMATTR Value 10k
SYMBOL res -448 272 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 10k
SYMBOL res -448 176 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 10k
SYMBOL res -448 512 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R20
SYMATTR Value 10k
SYMBOL res -448 416 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R21
SYMATTR Value 10k
SYMBOL diode -272 496 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D3
SYMATTR Value 1N4148
SYMBOL res -112 464 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R22
SYMATTR Value 1
SYMBOL res -112 224 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R23
SYMATTR Value 4.7k
SYMBOL voltage -560 432 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName V10
SYMATTR Value -.5
SYMBOL res 32 224 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value 4.7k
SYMBOL res 752 208 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 4.7k
SYMBOL voltage -560 192 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V6
SYMATTR Value SINE(-.5 .3 500)
SYMBOL res -448 736 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 10k
SYMBOL res -448 640 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 10k
SYMBOL diode -208 688 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D1
SYMATTR Value 1N4148
SYMBOL res -112 688 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 1
SYMBOL voltage -560 656 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName V3
SYMATTR Value .5
SYMBOL Opamps\\AD8628 -336 640 R0
SYMATTR InstName U1
SYMBOL Opamps\\AD8628 -336 416 R0
SYMATTR InstName U4
SYMBOL Opamps\\AD8628 -336 176 R0
SYMATTR InstName U5
SYMBOL Opamps\\AD8628 128 192 R0
SYMATTR InstName U6
SYMBOL res 1248 288 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value 10k
SYMBOL res 1104 352 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R13
SYMATTR Value 10k
SYMBOL res 1104 448 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R14
SYMATTR Value 10k
SYMBOL res 1248 496 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R19
SYMATTR Value 10k
SYMBOL res 896 544 R0
SYMATTR InstName Rload2
SYMATTR Value .9
SYMBOL Opamps\\AD8691 1120 0 R0
SYMATTR InstName U2
SYMBOL Opamps\\AD8691 1184 352 R0
SYMATTR InstName U8
SYMBOL voltage 912 624 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V9
SYMATTR Value 10
SYMBOL nmos 528 656 R0
SYMATTR InstName M1
SYMATTR Value BSC010NE2LS
SYMBOL pmos 528 656 M180
SYMATTR InstName M2
SYMATTR Value Si7461DP
SYMBOL voltage 640 448 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V8
SYMATTR Value SINE(10 10 500)
SYMBOL pmos 352 752 M180
SYMATTR InstName M3
SYMATTR Value Si7461DP
SYMBOL nmos 352 560 R0
SYMATTR InstName M4
SYMATTR Value BSC010NE2LS
TEXT 424 16 Left 2 ;Driver Amplifier\n(HV opamp)
TEXT 720 -80 Left 2 ;Driver
TEXT -376 128 Left 2 ;Voltage Control
TEXT 80 16 Left 2 ;Error\nIntegrator
TEXT -376 368 Left 2 ;Source Control
TEXT -936 16 Left 2 !.tran 3ms uic
TEXT 1232 -104 Left 2 ;1/20 V/V differential voltage sense\n(re-centering 0V -> +Vref, HV opamp)
TEXT -1056 -8 Left 2 ;Voltage Rails
TEXT 1048 -104 Left 2 ;Voltage Sense
TEXT 1288 240 Left 2 ;1/10 V/A current sense\n(HV opamp)
TEXT 1112 248 Left 2 ;Current Sense
TEXT 528 792 Left 2 ;Inverting AB\npush-pull
TEXT 352 792 Left 2 ;FET option
