(kicad_sch (version 20230121) (generator eeschema)

  (uuid b55f6c44-5d5d-4524-bb86-893662f64598)

  (paper "A4")

  (lib_symbols
    (symbol "Device:Q_PMOS_DGS" (pin_numbers hide) (pin_names (offset 0) hide) (in_bom yes) (on_board yes)
      (property "Reference" "Q" (at 5.08 1.27 0)
        (effects (font (size 1.27 1.27)) (justify left))
      )
      (property "Value" "Q_PMOS_DGS" (at 5.08 -1.27 0)
        (effects (font (size 1.27 1.27)) (justify left))
      )
      (property "Footprint" "" (at 5.08 2.54 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (property "Datasheet" "~" (at 0 0 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (property "ki_keywords" "transistor PMOS P-MOS P-MOSFET" (at 0 0 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (property "ki_description" "P-MOSFET transistor, drain/gate/source" (at 0 0 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (symbol "Q_PMOS_DGS_0_1"
        (polyline
          (pts
            (xy 0.254 0)
            (xy -2.54 0)
          )
          (stroke (width 0) (type default))
          (fill (type none))
        )
        (polyline
          (pts
            (xy 0.254 1.905)
            (xy 0.254 -1.905)
          )
          (stroke (width 0.254) (type default))
          (fill (type none))
        )
        (polyline
          (pts
            (xy 0.762 -1.27)
            (xy 0.762 -2.286)
          )
          (stroke (width 0.254) (type default))
          (fill (type none))
        )
        (polyline
          (pts
            (xy 0.762 0.508)
            (xy 0.762 -0.508)
          )
          (stroke (width 0.254) (type default))
          (fill (type none))
        )
        (polyline
          (pts
            (xy 0.762 2.286)
            (xy 0.762 1.27)
          )
          (stroke (width 0.254) (type default))
          (fill (type none))
        )
        (polyline
          (pts
            (xy 2.54 2.54)
            (xy 2.54 1.778)
          )
          (stroke (width 0) (type default))
          (fill (type none))
        )
        (polyline
          (pts
            (xy 2.54 -2.54)
            (xy 2.54 0)
            (xy 0.762 0)
          )
          (stroke (width 0) (type default))
          (fill (type none))
        )
        (polyline
          (pts
            (xy 0.762 1.778)
            (xy 3.302 1.778)
            (xy 3.302 -1.778)
            (xy 0.762 -1.778)
          )
          (stroke (width 0) (type default))
          (fill (type none))
        )
        (polyline
          (pts
            (xy 2.286 0)
            (xy 1.27 0.381)
            (xy 1.27 -0.381)
            (xy 2.286 0)
          )
          (stroke (width 0) (type default))
          (fill (type outline))
        )
        (polyline
          (pts
            (xy 2.794 -0.508)
            (xy 2.921 -0.381)
            (xy 3.683 -0.381)
            (xy 3.81 -0.254)
          )
          (stroke (width 0) (type default))
          (fill (type none))
        )
        (polyline
          (pts
            (xy 3.302 -0.381)
            (xy 2.921 0.254)
            (xy 3.683 0.254)
            (xy 3.302 -0.381)
          )
          (stroke (width 0) (type default))
          (fill (type none))
        )
        (circle (center 1.651 0) (radius 2.794)
          (stroke (width 0.254) (type default))
          (fill (type none))
        )
        (circle (center 2.54 -1.778) (radius 0.254)
          (stroke (width 0) (type default))
          (fill (type outline))
        )
        (circle (center 2.54 1.778) (radius 0.254)
          (stroke (width 0) (type default))
          (fill (type outline))
        )
      )
      (symbol "Q_PMOS_DGS_1_1"
        (pin passive line (at 2.54 5.08 270) (length 2.54)
          (name "D" (effects (font (size 1.27 1.27))))
          (number "1" (effects (font (size 1.27 1.27))))
        )
        (pin input line (at -5.08 0 0) (length 2.54)
          (name "G" (effects (font (size 1.27 1.27))))
          (number "2" (effects (font (size 1.27 1.27))))
        )
        (pin passive line (at 2.54 -5.08 90) (length 2.54)
          (name "S" (effects (font (size 1.27 1.27))))
          (number "3" (effects (font (size 1.27 1.27))))
        )
      )
    )
    (symbol "Device:R" (pin_names (offset 0)) (in_bom yes) (on_board yes)
      (property "Reference" "R" (at 2.032 0 90)
        (effects (font (size 1.27 1.27)))
      )
      (property "Value" "R" (at 0 0 90)
        (effects (font (size 1.27 1.27)))
      )
      (property "Footprint" "" (at -1.778 0 90)
        (effects (font (size 1.27 1.27)) hide)
      )
      (property "Datasheet" "~" (at 0 0 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (property "ki_keywords" "R res resistor" (at 0 0 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (property "ki_description" "Resistor" (at 0 0 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (property "ki_fp_filters" "R_*" (at 0 0 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (symbol "R_0_1"
        (rectangle (start -1.016 -2.54) (end 1.016 2.54)
          (stroke (width 0.254) (type default))
          (fill (type none))
        )
      )
      (symbol "R_1_1"
        (pin passive line (at 0 3.81 270) (length 1.27)
          (name "~" (effects (font (size 1.27 1.27))))
          (number "1" (effects (font (size 1.27 1.27))))
        )
        (pin passive line (at 0 -3.81 90) (length 1.27)
          (name "~" (effects (font (size 1.27 1.27))))
          (number "2" (effects (font (size 1.27 1.27))))
        )
      )
    )
    (symbol "power:GND" (power) (pin_names (offset 0)) (in_bom yes) (on_board yes)
      (property "Reference" "#PWR" (at 0 -6.35 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (property "Value" "GND" (at 0 -3.81 0)
        (effects (font (size 1.27 1.27)))
      )
      (property "Footprint" "" (at 0 0 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (property "Datasheet" "" (at 0 0 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (property "ki_keywords" "power-flag" (at 0 0 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (property "ki_description" "Power symbol creates a global label with name \"GND\" , ground" (at 0 0 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (symbol "GND_0_1"
        (polyline
          (pts
            (xy 0 0)
            (xy 0 -1.27)
            (xy 1.27 -1.27)
            (xy 0 -2.54)
            (xy -1.27 -1.27)
            (xy 0 -1.27)
          )
          (stroke (width 0) (type default))
          (fill (type none))
        )
      )
      (symbol "GND_1_1"
        (pin power_in line (at 0 0 270) (length 0) hide
          (name "GND" (effects (font (size 1.27 1.27))))
          (number "1" (effects (font (size 1.27 1.27))))
        )
      )
    )
  )

  (junction (at 175.26 83.82) (diameter 0) (color 0 0 0 0)
    (uuid 10212dac-4f1e-4d14-be49-32f5ceabf910)
  )
  (junction (at 175.26 73.66) (diameter 0) (color 0 0 0 0)
    (uuid 1a3a3e89-f0d2-4b9a-8aeb-648dddc3db3c)
  )
  (junction (at 182.88 83.82) (diameter 0) (color 0 0 0 0)
    (uuid 414f0070-564b-405d-b71b-214b1d92e219)
  )
  (junction (at 152.4 86.36) (diameter 0) (color 0 0 0 0)
    (uuid 886a151f-c6c3-4d9e-a86d-cacbfd10639e)
  )
  (junction (at 152.4 73.66) (diameter 0) (color 0 0 0 0)
    (uuid 921f02ca-3043-464e-8d30-5a83209e363c)
  )

  (wire (pts (xy 165.1 83.82) (xy 175.26 83.82))
    (stroke (width 0) (type default))
    (uuid 00d69aa2-b784-4f21-8907-9b978a751f45)
  )
  (wire (pts (xy 167.64 78.74) (xy 167.64 86.36))
    (stroke (width 0) (type default))
    (uuid 19eb8347-60f3-469e-82b7-99c63bbdb1a5)
  )
  (wire (pts (xy 152.4 86.36) (xy 152.4 88.9))
    (stroke (width 0) (type default))
    (uuid 1d5f332d-27e6-4f0c-ac09-a1a0e71bc341)
  )
  (wire (pts (xy 160.02 78.74) (xy 165.1 78.74))
    (stroke (width 0) (type default))
    (uuid 3dd7ff86-72ff-43b5-b894-0e5a62f25699)
  )
  (wire (pts (xy 182.88 82.55) (xy 182.88 83.82))
    (stroke (width 0) (type default))
    (uuid 5e51fcb7-169a-4bee-b2a4-e462b241d926)
  )
  (wire (pts (xy 165.1 78.74) (xy 165.1 83.82))
    (stroke (width 0) (type default))
    (uuid 6b9a75f8-68c2-4953-839d-6cfc0078aa94)
  )
  (wire (pts (xy 182.88 74.93) (xy 182.88 73.66))
    (stroke (width 0) (type default))
    (uuid 6cc644e6-986c-43a4-94db-4be6fad9d9f9)
  )
  (wire (pts (xy 182.88 83.82) (xy 175.26 83.82))
    (stroke (width 0) (type default))
    (uuid 7c3d3d02-ed81-48d3-a207-98a8631ab8ed)
  )
  (wire (pts (xy 124.46 101.6) (xy 127 101.6))
    (stroke (width 0) (type default))
    (uuid 864c531c-87c9-485b-a44e-d9aa537f522b)
  )
  (wire (pts (xy 152.4 96.52) (xy 152.4 99.06))
    (stroke (width 0) (type default))
    (uuid 9817d9d6-40c8-4a6e-8baa-964fd7e97de8)
  )
  (wire (pts (xy 152.4 83.82) (xy 152.4 86.36))
    (stroke (width 0) (type default))
    (uuid 9848f6af-1634-4e92-bab4-6b1ff52cdda6)
  )
  (wire (pts (xy 143.51 66.04) (xy 143.51 73.66))
    (stroke (width 0) (type default))
    (uuid a087cf6a-b08b-4dbd-9e78-ded1fa1740e3)
  )
  (wire (pts (xy 143.51 73.66) (xy 152.4 73.66))
    (stroke (width 0) (type default))
    (uuid b6506fce-b46b-42ad-84fe-68ff496aed77)
  )
  (wire (pts (xy 182.88 83.82) (xy 187.96 83.82))
    (stroke (width 0) (type default))
    (uuid c7edf471-f510-4ced-ae0e-fa0b4de75aca)
  )
  (wire (pts (xy 152.4 73.66) (xy 175.26 73.66))
    (stroke (width 0) (type default))
    (uuid e141ea76-4b1b-417c-ae27-ff704152d25e)
  )
  (wire (pts (xy 185.42 66.04) (xy 143.51 66.04))
    (stroke (width 0) (type default))
    (uuid eea34a85-a1d6-4ae9-81a1-f5cac822cd7b)
  )
  (wire (pts (xy 182.88 73.66) (xy 175.26 73.66))
    (stroke (width 0) (type default))
    (uuid ef77f2e8-1b79-427e-9088-14c2209e45f7)
  )
  (wire (pts (xy 167.64 86.36) (xy 152.4 86.36))
    (stroke (width 0) (type default))
    (uuid f5e79150-59fd-4f02-98c7-6868d869f846)
  )

  (text "Pmos charger reverse protection\n" (at 91.44 50.8 0)
    (effects (font (size 1.27 1.27)) (justify left bottom))
    (uuid 1da01f70-7afb-4f15-b974-6c1835e03c06)
  )
  (text " R1 is used as a pull-up resistor for the gate of the detection PMOS (MP1), and R2 is used to pull up the gate of the blocking PMOS (MP2).\n\n The exact values will depend on the threshold voltage of the PMOS transistors and the voltage levels in the circuit. \n"
    (at 93.98 116.84 0)
    (effects (font (size 1.27 1.27)) (justify left bottom))
    (uuid 41dec564-3c08-4d5d-827a-8063627099b6)
  )
  (text "https://www.edn.com/reverse-voltage-protection-for-battery-chargers/"
    (at 129.54 50.8 0)
    (effects (font (size 1.27 1.27)) (justify left bottom))
    (uuid 5f74b5ea-42eb-4fd9-a485-a3913f25a338)
  )
  (text "The PMOS charger protection circuit uses two PMOS transistors (MP1 for detection, MP2 for blocking) to protect against reverse battery connection.\nOne PMOS isn't sufficient for bidirectional flow in charging/discharging because it can't simultaneously block reverse voltage and allow normal operation.\nMP1 detects reverse battery and disables MP2, preventing negative voltage transmission. Hence the MP2 is the main flow. \n\n"
    (at 91.44 62.23 0)
    (effects (font (size 1.27 1.27)) (justify left bottom))
    (uuid 6c9c3d07-5b15-4933-84ac-8fafec7fa9c0)
  )

  (hierarchical_label "pwr_out" (shape input) (at 185.42 66.04 0) (fields_autoplaced)
    (effects (font (size 1.27 1.27)) (justify left))
    (uuid 7e701471-7566-4ec7-bc5d-01c4b5f88ebf)
  )
  (hierarchical_label "pwr_in" (shape output) (at 187.96 83.82 0) (fields_autoplaced)
    (effects (font (size 1.27 1.27)) (justify left))
    (uuid a47934db-1933-4fca-a88e-84db51cda995)
  )
  (hierarchical_label "gnd" (shape input) (at 124.46 101.6 180) (fields_autoplaced)
    (effects (font (size 1.27 1.27)) (justify right))
    (uuid ffdf205e-8c01-42f5-9c74-59c89b39b0dd)
  )

  (symbol (lib_id "power:GND") (at 152.4 99.06 0) (unit 1)
    (in_bom yes) (on_board yes) (dnp no)
    (uuid 249a0bbc-9f7c-4275-b4f3-393dbf37d48b)
    (property "Reference" "#PWR0101" (at 152.4 105.41 0)
      (effects (font (size 1.27 1.27)) hide)
    )
    (property "Value" "GND" (at 149.86 99.06 0)
      (effects (font (size 1.27 1.27)))
    )
    (property "Footprint" "" (at 152.4 99.06 0)
      (effects (font (size 1.27 1.27)) hide)
    )
    (property "Datasheet" "" (at 152.4 99.06 0)
      (effects (font (size 1.27 1.27)) hide)
    )
    (pin "1" (uuid 93cb6b9d-dc3c-4212-bdb2-14b9fbce5dfd))
    (instances
      (project "PmosChargerReverseProtection"
        (path "/b55f6c44-5d5d-4524-bb86-893662f64598"
          (reference "#PWR0101") (unit 1)
        )
      )
    )
  )

  (symbol (lib_id "Device:Q_PMOS_DGS") (at 154.94 78.74 180) (unit 1)
    (in_bom yes) (on_board yes) (dnp no)
    (uuid 39f44928-01d2-4e2e-9e28-a7bb035b6c2b)
    (property "Reference" "mp1" (at 157.48 76.2 90)
      (effects (font (size 1.27 1.27)))
    )
    (property "Value" "~" (at 146.05 78.74 90)
      (effects (font (size 1.27 1.27)))
    )
    (property "Footprint" "" (at 149.86 81.28 0)
      (effects (font (size 1.27 1.27)) hide)
    )
    (property "Datasheet" "~" (at 154.94 78.74 0)
      (effects (font (size 1.27 1.27)) hide)
    )
    (pin "1" (uuid 7f8c2cee-fea2-41ff-b75f-a172df0b6682))
    (pin "2" (uuid 2b0a8bef-4d6f-471f-98b7-8ef6481abf6f))
    (pin "3" (uuid 3bdc09c6-a387-4d4b-a900-4d1aa3dc779f))
    (instances
      (project "PmosChargerReverseProtection"
        (path "/b55f6c44-5d5d-4524-bb86-893662f64598"
          (reference "mp1") (unit 1)
        )
      )
    )
  )

  (symbol (lib_id "Device:R") (at 182.88 78.74 0) (unit 1)
    (in_bom yes) (on_board yes) (dnp no)
    (uuid b1d99a40-8641-4ed8-8884-6528c7fc42da)
    (property "Reference" "r2" (at 184.15 76.2 0)
      (effects (font (size 1.27 1.27)) (justify left))
    )
    (property "Value" "~" (at 185.42 80.0099 0)
      (effects (font (size 1.27 1.27)) (justify left))
    )
    (property "Footprint" "" (at 181.102 78.74 90)
      (effects (font (size 1.27 1.27)) hide)
    )
    (property "Datasheet" "~" (at 182.88 78.74 0)
      (effects (font (size 1.27 1.27)) hide)
    )
    (pin "1" (uuid 8f3a61ef-ca01-4204-b37f-0e91638b33bf))
    (pin "2" (uuid 29dc8c29-43b3-4df7-be8d-c25d506c3f2d))
    (instances
      (project "PmosChargerReverseProtection"
        (path "/b55f6c44-5d5d-4524-bb86-893662f64598"
          (reference "r2") (unit 1)
        )
      )
    )
  )

  (symbol (lib_id "power:GND") (at 127 101.6 0) (unit 1)
    (in_bom yes) (on_board yes) (dnp no)
    (uuid bc23023a-7276-47fe-a42c-9a7cdbf61866)
    (property "Reference" "#PWR0102" (at 127 107.95 0)
      (effects (font (size 1.27 1.27)) hide)
    )
    (property "Value" "GND" (at 130.81 102.87 0)
      (effects (font (size 1.27 1.27)))
    )
    (property "Footprint" "" (at 127 101.6 0)
      (effects (font (size 1.27 1.27)) hide)
    )
    (property "Datasheet" "" (at 127 101.6 0)
      (effects (font (size 1.27 1.27)) hide)
    )
    (pin "1" (uuid fcb25af1-9e79-4795-8ac6-618ea9d6ddb8))
    (instances
      (project "PmosChargerReverseProtection"
        (path "/b55f6c44-5d5d-4524-bb86-893662f64598"
          (reference "#PWR0102") (unit 1)
        )
      )
    )
  )

  (symbol (lib_id "Device:Q_PMOS_DGS") (at 172.72 78.74 0) (mirror x) (unit 1)
    (in_bom yes) (on_board yes) (dnp no)
    (uuid ddd98509-3b5c-41ed-890f-7bff1485bfa3)
    (property "Reference" "mp2" (at 170.18 76.2 90)
      (effects (font (size 1.27 1.27)))
    )
    (property "Value" "~" (at 181.61 78.74 90)
      (effects (font (size 1.27 1.27)))
    )
    (property "Footprint" "" (at 177.8 81.28 0)
      (effects (font (size 1.27 1.27)) hide)
    )
    (property "Datasheet" "~" (at 172.72 78.74 0)
      (effects (font (size 1.27 1.27)) hide)
    )
    (pin "1" (uuid 58ee3eb4-04a2-4821-92be-247c8919b97d))
    (pin "2" (uuid 6e213455-1e93-48e5-b597-bfa1e619caa7))
    (pin "3" (uuid e476d24a-cfa9-4ce7-af2c-b755cc6d4c30))
    (instances
      (project "PmosChargerReverseProtection"
        (path "/b55f6c44-5d5d-4524-bb86-893662f64598"
          (reference "mp2") (unit 1)
        )
      )
    )
  )

  (symbol (lib_id "Device:R") (at 152.4 92.71 0) (unit 1)
    (in_bom yes) (on_board yes) (dnp no)
    (uuid e623adcb-9757-4891-aa89-19b72700eb8c)
    (property "Reference" "r1" (at 153.67 90.17 0)
      (effects (font (size 1.27 1.27)) (justify left))
    )
    (property "Value" "~" (at 154.94 93.9799 0)
      (effects (font (size 1.27 1.27)) (justify left))
    )
    (property "Footprint" "" (at 150.622 92.71 90)
      (effects (font (size 1.27 1.27)) hide)
    )
    (property "Datasheet" "~" (at 152.4 92.71 0)
      (effects (font (size 1.27 1.27)) hide)
    )
    (pin "1" (uuid 672b47e8-eaa1-42f6-971c-38e87621b0f0))
    (pin "2" (uuid f8de4d1b-51dc-49bf-8b36-454e5c933869))
    (instances
      (project "PmosChargerReverseProtection"
        (path "/b55f6c44-5d5d-4524-bb86-893662f64598"
          (reference "r1") (unit 1)
        )
      )
    )
  )

  (sheet_instances
    (path "/" (page "1"))
  )
)
